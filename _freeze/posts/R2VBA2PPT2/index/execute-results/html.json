{
  "hash": "8f9e8dc32411d1eb811dc08e45802022",
  "result": {
    "markdown": "---\ntitle: \"Unholy Trinity of R, Excel VBA and Powerpoint - Part 2 of 2\"\nsubtitle: \"Using R to trigger Excel VBA macros to create PowerPoint presentations\"\nabstract: \"This post demonstrates how to run VBA macros in Excel which in turn creates Presentations based off PowerPoint Templates.\"\nauthor: Vishal Katti\ndate: 2021-12-29\nimage: images/R2XL2PPT_logo.png\ncategories: [R, Excel, VBA, PowerPoint, openxlsx, RDCOMClient]\ncitation: true\nlicense: \"CC BY\"\nfilters:\n  - social-share\nshare:\n  permalink: \"https://vishalkatti.com/posts/R2VBA2PPT2\"\n  description: \"Check out Part 2 on running VBA Macros in Excel from R\"\n  twitter: true\n  facebook: true\n  reddit: true\n  stumble: false\n  tumblr: false\n  linkedin: true\n  email: true\n---\n\n\n\n\nThis is part 2 of 2. Read part 1\n[here](https://www.vishalkatti.com/posts/R2VBA2PPT1/ \"link to Part 1 of this article.\").\n\n## Quick Recap\n\nIn the previous post, we create the `.potx` template from the `.pptx`\nfile we wanted to automate and the Excel template with the macro `.xlsm`\nthat uses the PowerPoint template to create a new `.pptx` file with\ngiven data using VBA.\n\nThe report we want to automate is...\n\n::: {style=\"text-align:center;\"}\n![The Gapminder Report : The PowerPoint presentation we want to\nautomate](https://i.imgur.com/LL6UwWH.gif \"The Gapminder Report\"){#fig-gapminder}\n:::\n\n...and the Excel and PowerPoint template we created are shown in @fig-excel-with-macro.\n\n::: {style=\"text-align:center;\"}\n![Excel Template with VBA\nmacro](https://i.imgur.com/tB3QxhJ.png \"Excel Template with VBA macro\"){#fig-excel-with-macro}\n:::\n\nIn this post, we will write the R script that will first massage the\ndata into desired format and then load the data for one region into the\nExcel template and execute the VBA macro that will create the PowerPoint\nfile with that data.\n\n## Strategy\n\nBefore we dive into code, we need to check a few things. We wish to\ncreate a presentation for each continent in the Gapminder data. A closer\nlook at the Presentation will tell you what kind of data we need for\neach slide/graph/table while the Excel template will reveal what should\nthe structure of each dataset should be. While looking into this\nstructure, some questions will pop-up. The idea here is to create the\ndatasets in such a way that they can be easily filtered for each\ncontinent and the resultant table can be written to the Excel template\nwithout any or very little modification. Let us proceed slide-by-slide.\n\n## Creating the datasets\n\n### Slide 1\n\nSlide 1 is the title page and needs 2 strings; one for Title, one for\nSubtitle. The Title for the base presentation is \"World Population\". For\neach continent, it could be \"\\<continent_name\\> Population\". The\nsubtitle is a combination of Author Name and Created Date. So we need a\nstring like \"\\<author_name\\> \\| \\<created_date\\>\" where created_date is\nthe formatted system date.\n\nThese strings can be created while writing the data to the Excel\ntemplate.\n\n### Slide 2\n\nThe chart on slide 2 needs raw data structured as below. You will notice\nthat at a continent-level, this table needs a minimum of 5 countries. Do\nwe have any continents in the Gapminder data with less than 5 countries?\nYes, we have Oceania with only Australia and New Zealand. For ease of\nuse, let us include these countries along with Asian countries in a new\n`Region` variable.\n\n::: {style=\"text-align:center;\"}\n![02_chart](https://i.imgur.com/KvGxnyt.png \"02_chart\"){#fig-slide2}\n:::\n\nWe will create the `region` variable in the gapminder data. But first,\nlet us load some relevant packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(tidyverse.quiet = TRUE)\nlibrary(tidyverse) # duh!\nlibrary(rmarkdown) # to display the tables interactively in this post. Not really needed for the final solution.\nlibrary(openxlsx) # to write the data to the Excel Template.\n# library(RDCOMClient) # to load and run the Excel macro post data load.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in Gapminder data\ngp <- gapminder::gapminder\n\n# Create new region variable\ngp <- gp %>%\n  mutate(region = if_else(as.character(continent) %in% c(\"Asia\",\"Oceania\"),\n                          \"Asia-Pacific\", \n                          as.character(continent)),\n         country = as.character(country))\n\n# Keep only relevant columns\ngp <- gp %>% select(region, country, year, pop)\n\n# View details\nglimpse(gp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,704\nColumns: 4\n$ region  <chr> \"Asia-Pacific\", \"Asia-Pacific\", \"Asia-Pacific\", \"Asia-Pacific\"~\n$ country <chr> \"Afghanistan\", \"Afghanistan\", \"Afghanistan\", \"Afghanistan\", \"A~\n$ year    <int> 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, 20~\n$ pop     <int> 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 1288~\n```\n:::\n:::\n\n\nNow that we have the source data available, we must now create the\ndatasets we need that we can write to the Excel template for each\nregion.\n\nThe required table in @fig-slide2 shows the top 4 countries (based on 2007 population)\nand all other countries clubbed into 'others' in a given region and then\nthe total population of the region on a yearly basis. This table has to\nbe created for all 4 regions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_trend <- gp %>%\n  group_by(region, country, year) %>% \n  summarise(pop = sum(pop, na.rm = TRUE),\n            .groups = 'drop') %>%\n  mutate(pop = round(pop/1E6, 0)) %>% # population in millions\n  pivot_wider(names_from = year, values_from = pop, names_sort = TRUE) %>% \n  arrange(desc(`2007`)) # sort by max pop to min pop in latest year i.e. 2007\n\npaged_table(pop_trend)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"region\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"country\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"1952\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1957\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1962\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1967\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1972\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1977\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1982\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1987\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1992\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1997\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2002\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2007\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Asia-Pacific\",\"2\":\"China\",\"3\":\"556\",\"4\":\"637\",\"5\":\"666\",\"6\":\"755\",\"7\":\"862\",\"8\":\"943\",\"9\":\"1000\",\"10\":\"1084\",\"11\":\"1165\",\"12\":\"1230\",\"13\":\"1280\",\"14\":\"1319\"},{\"1\":\"Asia-Pacific\",\"2\":\"India\",\"3\":\"372\",\"4\":\"409\",\"5\":\"454\",\"6\":\"506\",\"7\":\"567\",\"8\":\"634\",\"9\":\"708\",\"10\":\"788\",\"11\":\"872\",\"12\":\"959\",\"13\":\"1034\",\"14\":\"1110\"},{\"1\":\"Americas\",\"2\":\"United States\",\"3\":\"158\",\"4\":\"172\",\"5\":\"187\",\"6\":\"199\",\"7\":\"210\",\"8\":\"220\",\"9\":\"232\",\"10\":\"243\",\"11\":\"257\",\"12\":\"273\",\"13\":\"288\",\"14\":\"301\"},{\"1\":\"Asia-Pacific\",\"2\":\"Indonesia\",\"3\":\"82\",\"4\":\"90\",\"5\":\"99\",\"6\":\"109\",\"7\":\"121\",\"8\":\"137\",\"9\":\"153\",\"10\":\"169\",\"11\":\"185\",\"12\":\"199\",\"13\":\"211\",\"14\":\"224\"},{\"1\":\"Americas\",\"2\":\"Brazil\",\"3\":\"57\",\"4\":\"66\",\"5\":\"76\",\"6\":\"88\",\"7\":\"101\",\"8\":\"114\",\"9\":\"129\",\"10\":\"143\",\"11\":\"156\",\"12\":\"169\",\"13\":\"180\",\"14\":\"190\"},{\"1\":\"Asia-Pacific\",\"2\":\"Pakistan\",\"3\":\"41\",\"4\":\"47\",\"5\":\"53\",\"6\":\"61\",\"7\":\"69\",\"8\":\"78\",\"9\":\"91\",\"10\":\"105\",\"11\":\"120\",\"12\":\"136\",\"13\":\"153\",\"14\":\"169\"},{\"1\":\"Asia-Pacific\",\"2\":\"Bangladesh\",\"3\":\"47\",\"4\":\"51\",\"5\":\"57\",\"6\":\"63\",\"7\":\"71\",\"8\":\"80\",\"9\":\"93\",\"10\":\"104\",\"11\":\"114\",\"12\":\"123\",\"13\":\"136\",\"14\":\"150\"},{\"1\":\"Africa\",\"2\":\"Nigeria\",\"3\":\"33\",\"4\":\"37\",\"5\":\"42\",\"6\":\"47\",\"7\":\"54\",\"8\":\"62\",\"9\":\"73\",\"10\":\"82\",\"11\":\"93\",\"12\":\"106\",\"13\":\"120\",\"14\":\"135\"},{\"1\":\"Asia-Pacific\",\"2\":\"Japan\",\"3\":\"86\",\"4\":\"92\",\"5\":\"96\",\"6\":\"101\",\"7\":\"107\",\"8\":\"114\",\"9\":\"118\",\"10\":\"122\",\"11\":\"124\",\"12\":\"126\",\"13\":\"127\",\"14\":\"127\"},{\"1\":\"Americas\",\"2\":\"Mexico\",\"3\":\"30\",\"4\":\"35\",\"5\":\"41\",\"6\":\"48\",\"7\":\"56\",\"8\":\"64\",\"9\":\"72\",\"10\":\"80\",\"11\":\"88\",\"12\":\"96\",\"13\":\"102\",\"14\":\"109\"},{\"1\":\"Asia-Pacific\",\"2\":\"Philippines\",\"3\":\"22\",\"4\":\"26\",\"5\":\"30\",\"6\":\"35\",\"7\":\"41\",\"8\":\"47\",\"9\":\"53\",\"10\":\"60\",\"11\":\"67\",\"12\":\"75\",\"13\":\"83\",\"14\":\"91\"},{\"1\":\"Asia-Pacific\",\"2\":\"Vietnam\",\"3\":\"26\",\"4\":\"29\",\"5\":\"34\",\"6\":\"39\",\"7\":\"45\",\"8\":\"51\",\"9\":\"56\",\"10\":\"63\",\"11\":\"70\",\"12\":\"76\",\"13\":\"81\",\"14\":\"85\"},{\"1\":\"Europe\",\"2\":\"Germany\",\"3\":\"69\",\"4\":\"71\",\"5\":\"74\",\"6\":\"76\",\"7\":\"79\",\"8\":\"78\",\"9\":\"78\",\"10\":\"78\",\"11\":\"81\",\"12\":\"82\",\"13\":\"82\",\"14\":\"82\"},{\"1\":\"Africa\",\"2\":\"Egypt\",\"3\":\"22\",\"4\":\"25\",\"5\":\"28\",\"6\":\"32\",\"7\":\"35\",\"8\":\"39\",\"9\":\"46\",\"10\":\"53\",\"11\":\"59\",\"12\":\"66\",\"13\":\"73\",\"14\":\"80\"},{\"1\":\"Africa\",\"2\":\"Ethiopia\",\"3\":\"21\",\"4\":\"23\",\"5\":\"25\",\"6\":\"28\",\"7\":\"31\",\"8\":\"35\",\"9\":\"38\",\"10\":\"43\",\"11\":\"52\",\"12\":\"60\",\"13\":\"68\",\"14\":\"77\"},{\"1\":\"Europe\",\"2\":\"Turkey\",\"3\":\"22\",\"4\":\"26\",\"5\":\"30\",\"6\":\"33\",\"7\":\"37\",\"8\":\"42\",\"9\":\"47\",\"10\":\"53\",\"11\":\"58\",\"12\":\"63\",\"13\":\"67\",\"14\":\"71\"},{\"1\":\"Asia-Pacific\",\"2\":\"Iran\",\"3\":\"17\",\"4\":\"20\",\"5\":\"23\",\"6\":\"27\",\"7\":\"31\",\"8\":\"35\",\"9\":\"43\",\"10\":\"52\",\"11\":\"60\",\"12\":\"63\",\"13\":\"67\",\"14\":\"69\"},{\"1\":\"Africa\",\"2\":\"Congo, Dem. Rep.\",\"3\":\"14\",\"4\":\"16\",\"5\":\"17\",\"6\":\"20\",\"7\":\"23\",\"8\":\"26\",\"9\":\"31\",\"10\":\"35\",\"11\":\"42\",\"12\":\"48\",\"13\":\"55\",\"14\":\"65\"},{\"1\":\"Asia-Pacific\",\"2\":\"Thailand\",\"3\":\"21\",\"4\":\"25\",\"5\":\"29\",\"6\":\"34\",\"7\":\"39\",\"8\":\"44\",\"9\":\"49\",\"10\":\"53\",\"11\":\"57\",\"12\":\"60\",\"13\":\"63\",\"14\":\"65\"},{\"1\":\"Europe\",\"2\":\"France\",\"3\":\"42\",\"4\":\"44\",\"5\":\"47\",\"6\":\"50\",\"7\":\"52\",\"8\":\"53\",\"9\":\"54\",\"10\":\"56\",\"11\":\"57\",\"12\":\"59\",\"13\":\"60\",\"14\":\"61\"},{\"1\":\"Europe\",\"2\":\"United Kingdom\",\"3\":\"50\",\"4\":\"51\",\"5\":\"53\",\"6\":\"55\",\"7\":\"56\",\"8\":\"56\",\"9\":\"56\",\"10\":\"57\",\"11\":\"58\",\"12\":\"59\",\"13\":\"60\",\"14\":\"61\"},{\"1\":\"Europe\",\"2\":\"Italy\",\"3\":\"48\",\"4\":\"49\",\"5\":\"51\",\"6\":\"53\",\"7\":\"54\",\"8\":\"56\",\"9\":\"57\",\"10\":\"57\",\"11\":\"57\",\"12\":\"57\",\"13\":\"58\",\"14\":\"58\"},{\"1\":\"Asia-Pacific\",\"2\":\"Korea, Rep.\",\"3\":\"21\",\"4\":\"23\",\"5\":\"26\",\"6\":\"30\",\"7\":\"34\",\"8\":\"36\",\"9\":\"39\",\"10\":\"42\",\"11\":\"44\",\"12\":\"46\",\"13\":\"48\",\"14\":\"49\"},{\"1\":\"Asia-Pacific\",\"2\":\"Myanmar\",\"3\":\"20\",\"4\":\"22\",\"5\":\"24\",\"6\":\"26\",\"7\":\"28\",\"8\":\"32\",\"9\":\"35\",\"10\":\"38\",\"11\":\"41\",\"12\":\"43\",\"13\":\"46\",\"14\":\"48\"},{\"1\":\"Africa\",\"2\":\"South Africa\",\"3\":\"14\",\"4\":\"16\",\"5\":\"18\",\"6\":\"21\",\"7\":\"24\",\"8\":\"27\",\"9\":\"31\",\"10\":\"36\",\"11\":\"40\",\"12\":\"43\",\"13\":\"44\",\"14\":\"44\"},{\"1\":\"Americas\",\"2\":\"Colombia\",\"3\":\"12\",\"4\":\"14\",\"5\":\"17\",\"6\":\"20\",\"7\":\"23\",\"8\":\"25\",\"9\":\"28\",\"10\":\"31\",\"11\":\"34\",\"12\":\"38\",\"13\":\"41\",\"14\":\"44\"},{\"1\":\"Africa\",\"2\":\"Sudan\",\"3\":\"9\",\"4\":\"10\",\"5\":\"11\",\"6\":\"13\",\"7\":\"15\",\"8\":\"17\",\"9\":\"20\",\"10\":\"25\",\"11\":\"28\",\"12\":\"32\",\"13\":\"37\",\"14\":\"42\"},{\"1\":\"Americas\",\"2\":\"Argentina\",\"3\":\"18\",\"4\":\"20\",\"5\":\"21\",\"6\":\"23\",\"7\":\"25\",\"8\":\"27\",\"9\":\"29\",\"10\":\"32\",\"11\":\"34\",\"12\":\"36\",\"13\":\"38\",\"14\":\"40\"},{\"1\":\"Europe\",\"2\":\"Spain\",\"3\":\"29\",\"4\":\"30\",\"5\":\"31\",\"6\":\"33\",\"7\":\"35\",\"8\":\"36\",\"9\":\"38\",\"10\":\"39\",\"11\":\"40\",\"12\":\"40\",\"13\":\"40\",\"14\":\"40\"},{\"1\":\"Europe\",\"2\":\"Poland\",\"3\":\"26\",\"4\":\"28\",\"5\":\"30\",\"6\":\"32\",\"7\":\"33\",\"8\":\"35\",\"9\":\"36\",\"10\":\"38\",\"11\":\"38\",\"12\":\"39\",\"13\":\"39\",\"14\":\"39\"},{\"1\":\"Africa\",\"2\":\"Tanzania\",\"3\":\"8\",\"4\":\"9\",\"5\":\"11\",\"6\":\"13\",\"7\":\"15\",\"8\":\"17\",\"9\":\"20\",\"10\":\"23\",\"11\":\"27\",\"12\":\"31\",\"13\":\"35\",\"14\":\"38\"},{\"1\":\"Africa\",\"2\":\"Kenya\",\"3\":\"6\",\"4\":\"7\",\"5\":\"9\",\"6\":\"10\",\"7\":\"12\",\"8\":\"15\",\"9\":\"18\",\"10\":\"21\",\"11\":\"25\",\"12\":\"28\",\"13\":\"31\",\"14\":\"36\"},{\"1\":\"Africa\",\"2\":\"Morocco\",\"3\":\"10\",\"4\":\"11\",\"5\":\"13\",\"6\":\"15\",\"7\":\"17\",\"8\":\"18\",\"9\":\"20\",\"10\":\"23\",\"11\":\"26\",\"12\":\"29\",\"13\":\"31\",\"14\":\"34\"},{\"1\":\"Africa\",\"2\":\"Algeria\",\"3\":\"9\",\"4\":\"10\",\"5\":\"11\",\"6\":\"13\",\"7\":\"15\",\"8\":\"17\",\"9\":\"20\",\"10\":\"23\",\"11\":\"26\",\"12\":\"29\",\"13\":\"31\",\"14\":\"33\"},{\"1\":\"Americas\",\"2\":\"Canada\",\"3\":\"15\",\"4\":\"17\",\"5\":\"19\",\"6\":\"21\",\"7\":\"22\",\"8\":\"24\",\"9\":\"25\",\"10\":\"27\",\"11\":\"29\",\"12\":\"30\",\"13\":\"32\",\"14\":\"33\"},{\"1\":\"Asia-Pacific\",\"2\":\"Afghanistan\",\"3\":\"8\",\"4\":\"9\",\"5\":\"10\",\"6\":\"12\",\"7\":\"13\",\"8\":\"15\",\"9\":\"13\",\"10\":\"14\",\"11\":\"16\",\"12\":\"22\",\"13\":\"25\",\"14\":\"32\"},{\"1\":\"Africa\",\"2\":\"Uganda\",\"3\":\"6\",\"4\":\"7\",\"5\":\"8\",\"6\":\"9\",\"7\":\"10\",\"8\":\"11\",\"9\":\"13\",\"10\":\"15\",\"11\":\"18\",\"12\":\"21\",\"13\":\"25\",\"14\":\"29\"},{\"1\":\"Americas\",\"2\":\"Peru\",\"3\":\"8\",\"4\":\"9\",\"5\":\"11\",\"6\":\"12\",\"7\":\"14\",\"8\":\"16\",\"9\":\"18\",\"10\":\"20\",\"11\":\"22\",\"12\":\"25\",\"13\":\"27\",\"14\":\"29\"},{\"1\":\"Asia-Pacific\",\"2\":\"Nepal\",\"3\":\"9\",\"4\":\"10\",\"5\":\"10\",\"6\":\"11\",\"7\":\"12\",\"8\":\"14\",\"9\":\"16\",\"10\":\"18\",\"11\":\"20\",\"12\":\"23\",\"13\":\"26\",\"14\":\"29\"},{\"1\":\"Asia-Pacific\",\"2\":\"Saudi Arabia\",\"3\":\"4\",\"4\":\"4\",\"5\":\"5\",\"6\":\"6\",\"7\":\"6\",\"8\":\"8\",\"9\":\"11\",\"10\":\"15\",\"11\":\"17\",\"12\":\"21\",\"13\":\"25\",\"14\":\"28\"},{\"1\":\"Asia-Pacific\",\"2\":\"Iraq\",\"3\":\"5\",\"4\":\"6\",\"5\":\"7\",\"6\":\"9\",\"7\":\"10\",\"8\":\"12\",\"9\":\"14\",\"10\":\"17\",\"11\":\"18\",\"12\":\"21\",\"13\":\"24\",\"14\":\"27\"},{\"1\":\"Americas\",\"2\":\"Venezuela\",\"3\":\"5\",\"4\":\"7\",\"5\":\"8\",\"6\":\"10\",\"7\":\"12\",\"8\":\"14\",\"9\":\"16\",\"10\":\"18\",\"11\":\"20\",\"12\":\"22\",\"13\":\"24\",\"14\":\"26\"},{\"1\":\"Asia-Pacific\",\"2\":\"Malaysia\",\"3\":\"7\",\"4\":\"8\",\"5\":\"9\",\"6\":\"10\",\"7\":\"11\",\"8\":\"13\",\"9\":\"14\",\"10\":\"16\",\"11\":\"18\",\"12\":\"20\",\"13\":\"23\",\"14\":\"25\"},{\"1\":\"Africa\",\"2\":\"Ghana\",\"3\":\"6\",\"4\":\"6\",\"5\":\"7\",\"6\":\"8\",\"7\":\"9\",\"8\":\"11\",\"9\":\"11\",\"10\":\"14\",\"11\":\"16\",\"12\":\"18\",\"13\":\"21\",\"14\":\"23\"},{\"1\":\"Asia-Pacific\",\"2\":\"Korea, Dem. Rep.\",\"3\":\"9\",\"4\":\"9\",\"5\":\"11\",\"6\":\"13\",\"7\":\"15\",\"8\":\"16\",\"9\":\"18\",\"10\":\"19\",\"11\":\"21\",\"12\":\"22\",\"13\":\"22\",\"14\":\"23\"},{\"1\":\"Asia-Pacific\",\"2\":\"Taiwan\",\"3\":\"9\",\"4\":\"10\",\"5\":\"12\",\"6\":\"14\",\"7\":\"15\",\"8\":\"17\",\"9\":\"19\",\"10\":\"20\",\"11\":\"21\",\"12\":\"22\",\"13\":\"22\",\"14\":\"23\"},{\"1\":\"Asia-Pacific\",\"2\":\"Yemen, Rep.\",\"3\":\"5\",\"4\":\"5\",\"5\":\"6\",\"6\":\"7\",\"7\":\"7\",\"8\":\"8\",\"9\":\"10\",\"10\":\"11\",\"11\":\"13\",\"12\":\"16\",\"13\":\"19\",\"14\":\"22\"},{\"1\":\"Europe\",\"2\":\"Romania\",\"3\":\"17\",\"4\":\"18\",\"5\":\"19\",\"6\":\"19\",\"7\":\"21\",\"8\":\"22\",\"9\":\"22\",\"10\":\"23\",\"11\":\"23\",\"12\":\"23\",\"13\":\"22\",\"14\":\"22\"},{\"1\":\"Africa\",\"2\":\"Mozambique\",\"3\":\"6\",\"4\":\"7\",\"5\":\"8\",\"6\":\"9\",\"7\":\"10\",\"8\":\"11\",\"9\":\"13\",\"10\":\"13\",\"11\":\"13\",\"12\":\"17\",\"13\":\"18\",\"14\":\"20\"},{\"1\":\"Asia-Pacific\",\"2\":\"Australia\",\"3\":\"9\",\"4\":\"10\",\"5\":\"11\",\"6\":\"12\",\"7\":\"13\",\"8\":\"14\",\"9\":\"15\",\"10\":\"16\",\"11\":\"17\",\"12\":\"19\",\"13\":\"20\",\"14\":\"20\"},{\"1\":\"Asia-Pacific\",\"2\":\"Sri Lanka\",\"3\":\"8\",\"4\":\"9\",\"5\":\"10\",\"6\":\"12\",\"7\":\"13\",\"8\":\"14\",\"9\":\"15\",\"10\":\"16\",\"11\":\"18\",\"12\":\"19\",\"13\":\"20\",\"14\":\"20\"},{\"1\":\"Africa\",\"2\":\"Madagascar\",\"3\":\"5\",\"4\":\"5\",\"5\":\"6\",\"6\":\"6\",\"7\":\"7\",\"8\":\"8\",\"9\":\"9\",\"10\":\"11\",\"11\":\"12\",\"12\":\"14\",\"13\":\"16\",\"14\":\"19\"},{\"1\":\"Asia-Pacific\",\"2\":\"Syria\",\"3\":\"4\",\"4\":\"4\",\"5\":\"5\",\"6\":\"6\",\"7\":\"7\",\"8\":\"8\",\"9\":\"9\",\"10\":\"11\",\"11\":\"13\",\"12\":\"15\",\"13\":\"17\",\"14\":\"19\"},{\"1\":\"Africa\",\"2\":\"Cameroon\",\"3\":\"5\",\"4\":\"5\",\"5\":\"6\",\"6\":\"6\",\"7\":\"7\",\"8\":\"8\",\"9\":\"9\",\"10\":\"11\",\"11\":\"12\",\"12\":\"14\",\"13\":\"16\",\"14\":\"18\"},{\"1\":\"Africa\",\"2\":\"Cote d'Ivoire\",\"3\":\"3\",\"4\":\"3\",\"5\":\"4\",\"6\":\"5\",\"7\":\"6\",\"8\":\"7\",\"9\":\"9\",\"10\":\"11\",\"11\":\"13\",\"12\":\"15\",\"13\":\"16\",\"14\":\"18\"},{\"1\":\"Europe\",\"2\":\"Netherlands\",\"3\":\"10\",\"4\":\"11\",\"5\":\"12\",\"6\":\"13\",\"7\":\"13\",\"8\":\"14\",\"9\":\"14\",\"10\":\"15\",\"11\":\"15\",\"12\":\"16\",\"13\":\"16\",\"14\":\"17\"},{\"1\":\"Americas\",\"2\":\"Chile\",\"3\":\"6\",\"4\":\"7\",\"5\":\"8\",\"6\":\"9\",\"7\":\"10\",\"8\":\"11\",\"9\":\"11\",\"10\":\"12\",\"11\":\"14\",\"12\":\"15\",\"13\":\"15\",\"14\":\"16\"},{\"1\":\"Africa\",\"2\":\"Burkina Faso\",\"3\":\"4\",\"4\":\"5\",\"5\":\"5\",\"6\":\"5\",\"7\":\"5\",\"8\":\"6\",\"9\":\"7\",\"10\":\"8\",\"11\":\"9\",\"12\":\"10\",\"13\":\"12\",\"14\":\"14\"},{\"1\":\"Americas\",\"2\":\"Ecuador\",\"3\":\"4\",\"4\":\"4\",\"5\":\"5\",\"6\":\"5\",\"7\":\"6\",\"8\":\"7\",\"9\":\"8\",\"10\":\"10\",\"11\":\"11\",\"12\":\"12\",\"13\":\"13\",\"14\":\"14\"},{\"1\":\"Asia-Pacific\",\"2\":\"Cambodia\",\"3\":\"5\",\"4\":\"5\",\"5\":\"6\",\"6\":\"7\",\"7\":\"7\",\"8\":\"7\",\"9\":\"7\",\"10\":\"8\",\"11\":\"10\",\"12\":\"12\",\"13\":\"13\",\"14\":\"14\"},{\"1\":\"Africa\",\"2\":\"Malawi\",\"3\":\"3\",\"4\":\"3\",\"5\":\"4\",\"6\":\"4\",\"7\":\"5\",\"8\":\"6\",\"9\":\"7\",\"10\":\"8\",\"11\":\"10\",\"12\":\"10\",\"13\":\"12\",\"14\":\"13\"},{\"1\":\"Africa\",\"2\":\"Niger\",\"3\":\"3\",\"4\":\"4\",\"5\":\"4\",\"6\":\"5\",\"7\":\"5\",\"8\":\"6\",\"9\":\"6\",\"10\":\"7\",\"11\":\"8\",\"12\":\"10\",\"13\":\"11\",\"14\":\"13\"},{\"1\":\"Americas\",\"2\":\"Guatemala\",\"3\":\"3\",\"4\":\"4\",\"5\":\"4\",\"6\":\"5\",\"7\":\"5\",\"8\":\"6\",\"9\":\"6\",\"10\":\"7\",\"11\":\"8\",\"12\":\"10\",\"13\":\"11\",\"14\":\"13\"},{\"1\":\"Africa\",\"2\":\"Angola\",\"3\":\"4\",\"4\":\"5\",\"5\":\"5\",\"6\":\"5\",\"7\":\"6\",\"8\":\"6\",\"9\":\"7\",\"10\":\"8\",\"11\":\"9\",\"12\":\"10\",\"13\":\"11\",\"14\":\"12\"},{\"1\":\"Africa\",\"2\":\"Mali\",\"3\":\"4\",\"4\":\"4\",\"5\":\"5\",\"6\":\"5\",\"7\":\"6\",\"8\":\"6\",\"9\":\"7\",\"10\":\"8\",\"11\":\"8\",\"12\":\"9\",\"13\":\"11\",\"14\":\"12\"},{\"1\":\"Africa\",\"2\":\"Senegal\",\"3\":\"3\",\"4\":\"3\",\"5\":\"3\",\"6\":\"4\",\"7\":\"5\",\"8\":\"5\",\"9\":\"6\",\"10\":\"7\",\"11\":\"8\",\"12\":\"10\",\"13\":\"11\",\"14\":\"12\"},{\"1\":\"Africa\",\"2\":\"Zambia\",\"3\":\"3\",\"4\":\"3\",\"5\":\"3\",\"6\":\"4\",\"7\":\"5\",\"8\":\"5\",\"9\":\"6\",\"10\":\"7\",\"11\":\"8\",\"12\":\"9\",\"13\":\"11\",\"14\":\"12\"},{\"1\":\"Africa\",\"2\":\"Zimbabwe\",\"3\":\"3\",\"4\":\"4\",\"5\":\"4\",\"6\":\"5\",\"7\":\"6\",\"8\":\"7\",\"9\":\"8\",\"10\":\"9\",\"11\":\"11\",\"12\":\"11\",\"13\":\"12\",\"14\":\"12\"},{\"1\":\"Americas\",\"2\":\"Cuba\",\"3\":\"6\",\"4\":\"7\",\"5\":\"7\",\"6\":\"8\",\"7\":\"9\",\"8\":\"10\",\"9\":\"10\",\"10\":\"10\",\"11\":\"11\",\"12\":\"11\",\"13\":\"11\",\"14\":\"11\"},{\"1\":\"Europe\",\"2\":\"Greece\",\"3\":\"8\",\"4\":\"8\",\"5\":\"8\",\"6\":\"9\",\"7\":\"9\",\"8\":\"9\",\"9\":\"10\",\"10\":\"10\",\"11\":\"10\",\"12\":\"11\",\"13\":\"11\",\"14\":\"11\"},{\"1\":\"Europe\",\"2\":\"Portugal\",\"3\":\"9\",\"4\":\"9\",\"5\":\"9\",\"6\":\"9\",\"7\":\"9\",\"8\":\"10\",\"9\":\"10\",\"10\":\"10\",\"11\":\"10\",\"12\":\"10\",\"13\":\"10\",\"14\":\"11\"},{\"1\":\"Africa\",\"2\":\"Chad\",\"3\":\"3\",\"4\":\"3\",\"5\":\"3\",\"6\":\"3\",\"7\":\"4\",\"8\":\"4\",\"9\":\"5\",\"10\":\"5\",\"11\":\"6\",\"12\":\"8\",\"13\":\"9\",\"14\":\"10\"},{\"1\":\"Africa\",\"2\":\"Guinea\",\"3\":\"3\",\"4\":\"3\",\"5\":\"3\",\"6\":\"3\",\"7\":\"4\",\"8\":\"4\",\"9\":\"5\",\"10\":\"6\",\"11\":\"7\",\"12\":\"8\",\"13\":\"9\",\"14\":\"10\"},{\"1\":\"Africa\",\"2\":\"Tunisia\",\"3\":\"4\",\"4\":\"4\",\"5\":\"4\",\"6\":\"5\",\"7\":\"5\",\"8\":\"6\",\"9\":\"7\",\"10\":\"8\",\"11\":\"9\",\"12\":\"9\",\"13\":\"10\",\"14\":\"10\"},{\"1\":\"Europe\",\"2\":\"Belgium\",\"3\":\"9\",\"4\":\"9\",\"5\":\"9\",\"6\":\"10\",\"7\":\"10\",\"8\":\"10\",\"9\":\"10\",\"10\":\"10\",\"11\":\"10\",\"12\":\"10\",\"13\":\"10\",\"14\":\"10\"},{\"1\":\"Europe\",\"2\":\"Czech Republic\",\"3\":\"9\",\"4\":\"10\",\"5\":\"10\",\"6\":\"10\",\"7\":\"10\",\"8\":\"10\",\"9\":\"10\",\"10\":\"10\",\"11\":\"10\",\"12\":\"10\",\"13\":\"10\",\"14\":\"10\"},{\"1\":\"Europe\",\"2\":\"Hungary\",\"3\":\"10\",\"4\":\"10\",\"5\":\"10\",\"6\":\"10\",\"7\":\"10\",\"8\":\"11\",\"9\":\"11\",\"10\":\"11\",\"11\":\"10\",\"12\":\"10\",\"13\":\"10\",\"14\":\"10\"},{\"1\":\"Europe\",\"2\":\"Serbia\",\"3\":\"7\",\"4\":\"7\",\"5\":\"8\",\"6\":\"8\",\"7\":\"8\",\"8\":\"9\",\"9\":\"9\",\"10\":\"9\",\"11\":\"10\",\"12\":\"10\",\"13\":\"10\",\"14\":\"10\"},{\"1\":\"Africa\",\"2\":\"Rwanda\",\"3\":\"3\",\"4\":\"3\",\"5\":\"3\",\"6\":\"3\",\"7\":\"4\",\"8\":\"5\",\"9\":\"6\",\"10\":\"6\",\"11\":\"7\",\"12\":\"7\",\"13\":\"8\",\"14\":\"9\"},{\"1\":\"Africa\",\"2\":\"Somalia\",\"3\":\"3\",\"4\":\"3\",\"5\":\"3\",\"6\":\"3\",\"7\":\"4\",\"8\":\"4\",\"9\":\"6\",\"10\":\"7\",\"11\":\"6\",\"12\":\"7\",\"13\":\"8\",\"14\":\"9\"},{\"1\":\"Americas\",\"2\":\"Bolivia\",\"3\":\"3\",\"4\":\"3\",\"5\":\"4\",\"6\":\"4\",\"7\":\"5\",\"8\":\"5\",\"9\":\"6\",\"10\":\"6\",\"11\":\"7\",\"12\":\"8\",\"13\":\"8\",\"14\":\"9\"},{\"1\":\"Americas\",\"2\":\"Dominican Republic\",\"3\":\"2\",\"4\":\"3\",\"5\":\"3\",\"6\":\"4\",\"7\":\"5\",\"8\":\"5\",\"9\":\"6\",\"10\":\"7\",\"11\":\"7\",\"12\":\"8\",\"13\":\"9\",\"14\":\"9\"},{\"1\":\"Americas\",\"2\":\"Haiti\",\"3\":\"3\",\"4\":\"4\",\"5\":\"4\",\"6\":\"4\",\"7\":\"5\",\"8\":\"5\",\"9\":\"5\",\"10\":\"6\",\"11\":\"6\",\"12\":\"7\",\"13\":\"8\",\"14\":\"9\"},{\"1\":\"Europe\",\"2\":\"Sweden\",\"3\":\"7\",\"4\":\"7\",\"5\":\"8\",\"6\":\"8\",\"7\":\"8\",\"8\":\"8\",\"9\":\"8\",\"10\":\"8\",\"11\":\"9\",\"12\":\"9\",\"13\":\"9\",\"14\":\"9\"},{\"1\":\"Africa\",\"2\":\"Benin\",\"3\":\"2\",\"4\":\"2\",\"5\":\"2\",\"6\":\"2\",\"7\":\"3\",\"8\":\"3\",\"9\":\"4\",\"10\":\"4\",\"11\":\"5\",\"12\":\"6\",\"13\":\"7\",\"14\":\"8\"},{\"1\":\"Africa\",\"2\":\"Burundi\",\"3\":\"2\",\"4\":\"3\",\"5\":\"3\",\"6\":\"3\",\"7\":\"4\",\"8\":\"4\",\"9\":\"5\",\"10\":\"5\",\"11\":\"6\",\"12\":\"6\",\"13\":\"7\",\"14\":\"8\"},{\"1\":\"Europe\",\"2\":\"Austria\",\"3\":\"7\",\"4\":\"7\",\"5\":\"7\",\"6\":\"7\",\"7\":\"8\",\"8\":\"8\",\"9\":\"8\",\"10\":\"8\",\"11\":\"8\",\"12\":\"8\",\"13\":\"8\",\"14\":\"8\"},{\"1\":\"Europe\",\"2\":\"Switzerland\",\"3\":\"5\",\"4\":\"5\",\"5\":\"6\",\"6\":\"6\",\"7\":\"6\",\"8\":\"6\",\"9\":\"6\",\"10\":\"7\",\"11\":\"7\",\"12\":\"7\",\"13\":\"7\",\"14\":\"8\"},{\"1\":\"Americas\",\"2\":\"El Salvador\",\"3\":\"2\",\"4\":\"2\",\"5\":\"3\",\"6\":\"3\",\"7\":\"4\",\"8\":\"4\",\"9\":\"4\",\"10\":\"5\",\"11\":\"5\",\"12\":\"6\",\"13\":\"6\",\"14\":\"7\"},{\"1\":\"Americas\",\"2\":\"Honduras\",\"3\":\"2\",\"4\":\"2\",\"5\":\"2\",\"6\":\"3\",\"7\":\"3\",\"8\":\"3\",\"9\":\"4\",\"10\":\"4\",\"11\":\"5\",\"12\":\"6\",\"13\":\"7\",\"14\":\"7\"},{\"1\":\"Americas\",\"2\":\"Paraguay\",\"3\":\"2\",\"4\":\"2\",\"5\":\"2\",\"6\":\"2\",\"7\":\"3\",\"8\":\"3\",\"9\":\"3\",\"10\":\"4\",\"11\":\"4\",\"12\":\"5\",\"13\":\"6\",\"14\":\"7\"},{\"1\":\"Asia-Pacific\",\"2\":\"Hong Kong, China\",\"3\":\"2\",\"4\":\"3\",\"5\":\"3\",\"6\":\"4\",\"7\":\"4\",\"8\":\"5\",\"9\":\"5\",\"10\":\"6\",\"11\":\"6\",\"12\":\"6\",\"13\":\"7\",\"14\":\"7\"},{\"1\":\"Europe\",\"2\":\"Bulgaria\",\"3\":\"7\",\"4\":\"8\",\"5\":\"8\",\"6\":\"8\",\"7\":\"9\",\"8\":\"9\",\"9\":\"9\",\"10\":\"9\",\"11\":\"9\",\"12\":\"8\",\"13\":\"8\",\"14\":\"7\"},{\"1\":\"Africa\",\"2\":\"Libya\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"2\",\"7\":\"2\",\"8\":\"3\",\"9\":\"3\",\"10\":\"4\",\"11\":\"4\",\"12\":\"5\",\"13\":\"5\",\"14\":\"6\"},{\"1\":\"Africa\",\"2\":\"Sierra Leone\",\"3\":\"2\",\"4\":\"2\",\"5\":\"2\",\"6\":\"3\",\"7\":\"3\",\"8\":\"3\",\"9\":\"3\",\"10\":\"4\",\"11\":\"4\",\"12\":\"5\",\"13\":\"5\",\"14\":\"6\"},{\"1\":\"Africa\",\"2\":\"Togo\",\"3\":\"1\",\"4\":\"1\",\"5\":\"2\",\"6\":\"2\",\"7\":\"2\",\"8\":\"2\",\"9\":\"3\",\"10\":\"3\",\"11\":\"4\",\"12\":\"4\",\"13\":\"5\",\"14\":\"6\"},{\"1\":\"Americas\",\"2\":\"Nicaragua\",\"3\":\"1\",\"4\":\"1\",\"5\":\"2\",\"6\":\"2\",\"7\":\"2\",\"8\":\"3\",\"9\":\"3\",\"10\":\"3\",\"11\":\"4\",\"12\":\"5\",\"13\":\"5\",\"14\":\"6\"},{\"1\":\"Asia-Pacific\",\"2\":\"Israel\",\"3\":\"2\",\"4\":\"2\",\"5\":\"2\",\"6\":\"3\",\"7\":\"3\",\"8\":\"3\",\"9\":\"4\",\"10\":\"4\",\"11\":\"5\",\"12\":\"6\",\"13\":\"6\",\"14\":\"6\"},{\"1\":\"Asia-Pacific\",\"2\":\"Jordan\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"2\",\"8\":\"2\",\"9\":\"2\",\"10\":\"3\",\"11\":\"4\",\"12\":\"5\",\"13\":\"5\",\"14\":\"6\"},{\"1\":\"Africa\",\"2\":\"Eritrea\",\"3\":\"1\",\"4\":\"2\",\"5\":\"2\",\"6\":\"2\",\"7\":\"2\",\"8\":\"3\",\"9\":\"3\",\"10\":\"3\",\"11\":\"4\",\"12\":\"4\",\"13\":\"4\",\"14\":\"5\"},{\"1\":\"Asia-Pacific\",\"2\":\"Singapore\",\"3\":\"1\",\"4\":\"1\",\"5\":\"2\",\"6\":\"2\",\"7\":\"2\",\"8\":\"2\",\"9\":\"3\",\"10\":\"3\",\"11\":\"3\",\"12\":\"4\",\"13\":\"4\",\"14\":\"5\"},{\"1\":\"Europe\",\"2\":\"Bosnia and Herzegovina\",\"3\":\"3\",\"4\":\"3\",\"5\":\"3\",\"6\":\"4\",\"7\":\"4\",\"8\":\"4\",\"9\":\"4\",\"10\":\"4\",\"11\":\"4\",\"12\":\"4\",\"13\":\"4\",\"14\":\"5\"},{\"1\":\"Europe\",\"2\":\"Denmark\",\"3\":\"4\",\"4\":\"4\",\"5\":\"5\",\"6\":\"5\",\"7\":\"5\",\"8\":\"5\",\"9\":\"5\",\"10\":\"5\",\"11\":\"5\",\"12\":\"5\",\"13\":\"5\",\"14\":\"5\"},{\"1\":\"Europe\",\"2\":\"Finland\",\"3\":\"4\",\"4\":\"4\",\"5\":\"4\",\"6\":\"5\",\"7\":\"5\",\"8\":\"5\",\"9\":\"5\",\"10\":\"5\",\"11\":\"5\",\"12\":\"5\",\"13\":\"5\",\"14\":\"5\"},{\"1\":\"Europe\",\"2\":\"Norway\",\"3\":\"3\",\"4\":\"3\",\"5\":\"4\",\"6\":\"4\",\"7\":\"4\",\"8\":\"4\",\"9\":\"4\",\"10\":\"4\",\"11\":\"4\",\"12\":\"4\",\"13\":\"5\",\"14\":\"5\"},{\"1\":\"Europe\",\"2\":\"Slovak Republic\",\"3\":\"4\",\"4\":\"4\",\"5\":\"4\",\"6\":\"4\",\"7\":\"5\",\"8\":\"5\",\"9\":\"5\",\"10\":\"5\",\"11\":\"5\",\"12\":\"5\",\"13\":\"5\",\"14\":\"5\"},{\"1\":\"Africa\",\"2\":\"Central African Republic\",\"3\":\"1\",\"4\":\"1\",\"5\":\"2\",\"6\":\"2\",\"7\":\"2\",\"8\":\"2\",\"9\":\"2\",\"10\":\"3\",\"11\":\"3\",\"12\":\"4\",\"13\":\"4\",\"14\":\"4\"},{\"1\":\"Africa\",\"2\":\"Congo, Rep.\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"2\",\"9\":\"2\",\"10\":\"2\",\"11\":\"2\",\"12\":\"3\",\"13\":\"3\",\"14\":\"4\"},{\"1\":\"Americas\",\"2\":\"Costa Rica\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"2\",\"7\":\"2\",\"8\":\"2\",\"9\":\"2\",\"10\":\"3\",\"11\":\"3\",\"12\":\"4\",\"13\":\"4\",\"14\":\"4\"},{\"1\":\"Americas\",\"2\":\"Puerto Rico\",\"3\":\"2\",\"4\":\"2\",\"5\":\"2\",\"6\":\"3\",\"7\":\"3\",\"8\":\"3\",\"9\":\"3\",\"10\":\"3\",\"11\":\"4\",\"12\":\"4\",\"13\":\"4\",\"14\":\"4\"},{\"1\":\"Asia-Pacific\",\"2\":\"Lebanon\",\"3\":\"1\",\"4\":\"2\",\"5\":\"2\",\"6\":\"2\",\"7\":\"3\",\"8\":\"3\",\"9\":\"3\",\"10\":\"3\",\"11\":\"3\",\"12\":\"3\",\"13\":\"4\",\"14\":\"4\"},{\"1\":\"Asia-Pacific\",\"2\":\"New Zealand\",\"3\":\"2\",\"4\":\"2\",\"5\":\"2\",\"6\":\"3\",\"7\":\"3\",\"8\":\"3\",\"9\":\"3\",\"10\":\"3\",\"11\":\"3\",\"12\":\"4\",\"13\":\"4\",\"14\":\"4\"},{\"1\":\"Asia-Pacific\",\"2\":\"West Bank and Gaza\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"2\",\"11\":\"2\",\"12\":\"3\",\"13\":\"3\",\"14\":\"4\"},{\"1\":\"Europe\",\"2\":\"Albania\",\"3\":\"1\",\"4\":\"1\",\"5\":\"2\",\"6\":\"2\",\"7\":\"2\",\"8\":\"3\",\"9\":\"3\",\"10\":\"3\",\"11\":\"3\",\"12\":\"3\",\"13\":\"4\",\"14\":\"4\"},{\"1\":\"Europe\",\"2\":\"Croatia\",\"3\":\"4\",\"4\":\"4\",\"5\":\"4\",\"6\":\"4\",\"7\":\"4\",\"8\":\"4\",\"9\":\"4\",\"10\":\"4\",\"11\":\"4\",\"12\":\"4\",\"13\":\"4\",\"14\":\"4\"},{\"1\":\"Europe\",\"2\":\"Ireland\",\"3\":\"3\",\"4\":\"3\",\"5\":\"3\",\"6\":\"3\",\"7\":\"3\",\"8\":\"3\",\"9\":\"3\",\"10\":\"4\",\"11\":\"4\",\"12\":\"4\",\"13\":\"4\",\"14\":\"4\"},{\"1\":\"Africa\",\"2\":\"Liberia\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"2\",\"9\":\"2\",\"10\":\"2\",\"11\":\"2\",\"12\":\"2\",\"13\":\"3\",\"14\":\"3\"},{\"1\":\"Africa\",\"2\":\"Mauritania\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"2\",\"10\":\"2\",\"11\":\"2\",\"12\":\"2\",\"13\":\"3\",\"14\":\"3\"},{\"1\":\"Americas\",\"2\":\"Jamaica\",\"3\":\"1\",\"4\":\"2\",\"5\":\"2\",\"6\":\"2\",\"7\":\"2\",\"8\":\"2\",\"9\":\"2\",\"10\":\"2\",\"11\":\"2\",\"12\":\"3\",\"13\":\"3\",\"14\":\"3\"},{\"1\":\"Americas\",\"2\":\"Panama\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"2\",\"8\":\"2\",\"9\":\"2\",\"10\":\"2\",\"11\":\"2\",\"12\":\"3\",\"13\":\"3\",\"14\":\"3\"},{\"1\":\"Americas\",\"2\":\"Uruguay\",\"3\":\"2\",\"4\":\"2\",\"5\":\"3\",\"6\":\"3\",\"7\":\"3\",\"8\":\"3\",\"9\":\"3\",\"10\":\"3\",\"11\":\"3\",\"12\":\"3\",\"13\":\"3\",\"14\":\"3\"},{\"1\":\"Asia-Pacific\",\"2\":\"Kuwait\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"2\",\"11\":\"1\",\"12\":\"2\",\"13\":\"2\",\"14\":\"3\"},{\"1\":\"Asia-Pacific\",\"2\":\"Mongolia\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"2\",\"9\":\"2\",\"10\":\"2\",\"11\":\"2\",\"12\":\"2\",\"13\":\"3\",\"14\":\"3\"},{\"1\":\"Asia-Pacific\",\"2\":\"Oman\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"2\",\"11\":\"2\",\"12\":\"2\",\"13\":\"3\",\"14\":\"3\"},{\"1\":\"Africa\",\"2\":\"Botswana\",\"3\":\"0\",\"4\":\"0\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"2\",\"13\":\"2\",\"14\":\"2\"},{\"1\":\"Africa\",\"2\":\"Gambia\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"2\"},{\"1\":\"Africa\",\"2\":\"Lesotho\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"2\",\"11\":\"2\",\"12\":\"2\",\"13\":\"2\",\"14\":\"2\"},{\"1\":\"Africa\",\"2\":\"Namibia\",\"3\":\"0\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"2\",\"12\":\"2\",\"13\":\"2\",\"14\":\"2\"},{\"1\":\"Europe\",\"2\":\"Slovenia\",\"3\":\"1\",\"4\":\"2\",\"5\":\"2\",\"6\":\"2\",\"7\":\"2\",\"8\":\"2\",\"9\":\"2\",\"10\":\"2\",\"11\":\"2\",\"12\":\"2\",\"13\":\"2\",\"14\":\"2\"},{\"1\":\"Africa\",\"2\":\"Comoros\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"1\",\"13\":\"1\",\"14\":\"1\"},{\"1\":\"Africa\",\"2\":\"Equatorial Guinea\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\"},{\"1\":\"Africa\",\"2\":\"Gabon\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"1\"},{\"1\":\"Africa\",\"2\":\"Guinea-Bissau\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"1\"},{\"1\":\"Africa\",\"2\":\"Mauritius\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"1\"},{\"1\":\"Africa\",\"2\":\"Reunion\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"1\"},{\"1\":\"Africa\",\"2\":\"Swaziland\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"1\"},{\"1\":\"Americas\",\"2\":\"Trinidad and Tobago\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"1\"},{\"1\":\"Asia-Pacific\",\"2\":\"Bahrain\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"1\"},{\"1\":\"Europe\",\"2\":\"Montenegro\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"1\"},{\"1\":\"Africa\",\"2\":\"Djibouti\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"Africa\",\"2\":\"Sao Tome and Principe\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"Europe\",\"2\":\"Iceland\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nNow that we have the required columns, let's plan the row order. We\nnotice that, for each region, we have the top 4 countries (as per 2007)\n, followed by 'Others'. Let's create the `top-4` dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntop4 <- pop_trend %>% \n  group_by(region) %>% \n  slice_max(`2007`, n = 4, with_ties = FALSE) %>% \n  ungroup()\n\npaged_table(top4)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"region\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"country\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"1952\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1957\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1962\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1967\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1972\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1977\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1982\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1987\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1992\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1997\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2002\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2007\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Africa\",\"2\":\"Nigeria\",\"3\":\"33\",\"4\":\"37\",\"5\":\"42\",\"6\":\"47\",\"7\":\"54\",\"8\":\"62\",\"9\":\"73\",\"10\":\"82\",\"11\":\"93\",\"12\":\"106\",\"13\":\"120\",\"14\":\"135\"},{\"1\":\"Africa\",\"2\":\"Egypt\",\"3\":\"22\",\"4\":\"25\",\"5\":\"28\",\"6\":\"32\",\"7\":\"35\",\"8\":\"39\",\"9\":\"46\",\"10\":\"53\",\"11\":\"59\",\"12\":\"66\",\"13\":\"73\",\"14\":\"80\"},{\"1\":\"Africa\",\"2\":\"Ethiopia\",\"3\":\"21\",\"4\":\"23\",\"5\":\"25\",\"6\":\"28\",\"7\":\"31\",\"8\":\"35\",\"9\":\"38\",\"10\":\"43\",\"11\":\"52\",\"12\":\"60\",\"13\":\"68\",\"14\":\"77\"},{\"1\":\"Africa\",\"2\":\"Congo, Dem. Rep.\",\"3\":\"14\",\"4\":\"16\",\"5\":\"17\",\"6\":\"20\",\"7\":\"23\",\"8\":\"26\",\"9\":\"31\",\"10\":\"35\",\"11\":\"42\",\"12\":\"48\",\"13\":\"55\",\"14\":\"65\"},{\"1\":\"Americas\",\"2\":\"United States\",\"3\":\"158\",\"4\":\"172\",\"5\":\"187\",\"6\":\"199\",\"7\":\"210\",\"8\":\"220\",\"9\":\"232\",\"10\":\"243\",\"11\":\"257\",\"12\":\"273\",\"13\":\"288\",\"14\":\"301\"},{\"1\":\"Americas\",\"2\":\"Brazil\",\"3\":\"57\",\"4\":\"66\",\"5\":\"76\",\"6\":\"88\",\"7\":\"101\",\"8\":\"114\",\"9\":\"129\",\"10\":\"143\",\"11\":\"156\",\"12\":\"169\",\"13\":\"180\",\"14\":\"190\"},{\"1\":\"Americas\",\"2\":\"Mexico\",\"3\":\"30\",\"4\":\"35\",\"5\":\"41\",\"6\":\"48\",\"7\":\"56\",\"8\":\"64\",\"9\":\"72\",\"10\":\"80\",\"11\":\"88\",\"12\":\"96\",\"13\":\"102\",\"14\":\"109\"},{\"1\":\"Americas\",\"2\":\"Colombia\",\"3\":\"12\",\"4\":\"14\",\"5\":\"17\",\"6\":\"20\",\"7\":\"23\",\"8\":\"25\",\"9\":\"28\",\"10\":\"31\",\"11\":\"34\",\"12\":\"38\",\"13\":\"41\",\"14\":\"44\"},{\"1\":\"Asia-Pacific\",\"2\":\"China\",\"3\":\"556\",\"4\":\"637\",\"5\":\"666\",\"6\":\"755\",\"7\":\"862\",\"8\":\"943\",\"9\":\"1000\",\"10\":\"1084\",\"11\":\"1165\",\"12\":\"1230\",\"13\":\"1280\",\"14\":\"1319\"},{\"1\":\"Asia-Pacific\",\"2\":\"India\",\"3\":\"372\",\"4\":\"409\",\"5\":\"454\",\"6\":\"506\",\"7\":\"567\",\"8\":\"634\",\"9\":\"708\",\"10\":\"788\",\"11\":\"872\",\"12\":\"959\",\"13\":\"1034\",\"14\":\"1110\"},{\"1\":\"Asia-Pacific\",\"2\":\"Indonesia\",\"3\":\"82\",\"4\":\"90\",\"5\":\"99\",\"6\":\"109\",\"7\":\"121\",\"8\":\"137\",\"9\":\"153\",\"10\":\"169\",\"11\":\"185\",\"12\":\"199\",\"13\":\"211\",\"14\":\"224\"},{\"1\":\"Asia-Pacific\",\"2\":\"Pakistan\",\"3\":\"41\",\"4\":\"47\",\"5\":\"53\",\"6\":\"61\",\"7\":\"69\",\"8\":\"78\",\"9\":\"91\",\"10\":\"105\",\"11\":\"120\",\"12\":\"136\",\"13\":\"153\",\"14\":\"169\"},{\"1\":\"Europe\",\"2\":\"Germany\",\"3\":\"69\",\"4\":\"71\",\"5\":\"74\",\"6\":\"76\",\"7\":\"79\",\"8\":\"78\",\"9\":\"78\",\"10\":\"78\",\"11\":\"81\",\"12\":\"82\",\"13\":\"82\",\"14\":\"82\"},{\"1\":\"Europe\",\"2\":\"Turkey\",\"3\":\"22\",\"4\":\"26\",\"5\":\"30\",\"6\":\"33\",\"7\":\"37\",\"8\":\"42\",\"9\":\"47\",\"10\":\"53\",\"11\":\"58\",\"12\":\"63\",\"13\":\"67\",\"14\":\"71\"},{\"1\":\"Europe\",\"2\":\"France\",\"3\":\"42\",\"4\":\"44\",\"5\":\"47\",\"6\":\"50\",\"7\":\"52\",\"8\":\"53\",\"9\":\"54\",\"10\":\"56\",\"11\":\"57\",\"12\":\"59\",\"13\":\"60\",\"14\":\"61\"},{\"1\":\"Europe\",\"2\":\"United Kingdom\",\"3\":\"50\",\"4\":\"51\",\"5\":\"53\",\"6\":\"55\",\"7\":\"56\",\"8\":\"56\",\"9\":\"56\",\"10\":\"57\",\"11\":\"58\",\"12\":\"59\",\"13\":\"60\",\"14\":\"61\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nTo create the `others` dataset, we exclude all countries that are\npresent in the `top-4`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nothers <- pop_trend %>% \n  filter(!country %in% top4$country) %>% \n  group_by(region) %>% \n  summarise(across(.cols = -country, .fns = sum),\n            .groups = 'drop') %>% \n  mutate(country = \"Others\") %>% \n  select(region, country, everything())\n\npaged_table(others)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"region\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"country\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"1952\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1957\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1962\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1967\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1972\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1977\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1982\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1987\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1992\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1997\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2002\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2007\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Africa\",\"2\":\"Others\",\"3\":\"146\",\"4\":\"162\",\"5\":\"183\",\"6\":\"206\",\"7\":\"239\",\"8\":\"270\",\"9\":\"314\",\"10\":\"362\",\"11\":\"409\",\"12\":\"463\",\"13\":\"515\",\"14\":\"570\"},{\"1\":\"Americas\",\"2\":\"Others\",\"3\":\"88\",\"4\":\"101\",\"5\":\"113\",\"6\":\"127\",\"7\":\"143\",\"8\":\"156\",\"9\":\"167\",\"10\":\"185\",\"11\":\"202\",\"12\":\"224\",\"13\":\"238\",\"14\":\"254\"},{\"1\":\"Asia-Pacific\",\"2\":\"Others\",\"3\":\"354\",\"4\":\"391\",\"5\":\"436\",\"6\":\"493\",\"7\":\"546\",\"8\":\"608\",\"9\":\"672\",\"10\":\"745\",\"11\":\"811\",\"12\":\"882\",\"13\":\"949\",\"14\":\"1012\"},{\"1\":\"Europe\",\"2\":\"Others\",\"3\":\"235\",\"4\":\"244\",\"5\":\"257\",\"6\":\"269\",\"7\":\"278\",\"8\":\"289\",\"9\":\"294\",\"10\":\"301\",\"11\":\"303\",\"12\":\"305\",\"13\":\"307\",\"14\":\"310\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nWhile we create the `top-4` and `others` datasets separately, we will\ncombine them later at the very last moment before writing them to the\nExcel template.\n\nNow that we have the datasets needed for `02_chart`, let's proceed to\nthe create `02_table` . This table gives you the count of countries that\nfall under various population ranges.\n\n::: {style=\"text-align:center;\"}\n![02_table on Slide 2](https://i.imgur.com/uf3flVN.png \"02_table\"){#fig-slide22 width=60%}\n:::\n\nLet's create `02_table`. To create this table, we first create a new\nvariable called `pop_range`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_levels <- c('Less than 500K','500K - 1 Million',\n                '1M - 10 Million', '10M - 100 Million',\n                '100M - 1 Billion', 'More than 1 Billion')\n\ngp2007 <- gp %>% \n  filter(year == 2007) %>% \n  mutate(pop_range = case_when(pop < 5E5 ~ pop_levels[1],\n                               pop < 1E6 ~ pop_levels[2],\n                               pop < 1E7 ~ pop_levels[3],\n                               pop < 1E8 ~ pop_levels[4],\n                               pop < 1E9 ~ pop_levels[5],\n                               TRUE      ~ pop_levels[6]),\n         pop_range = factor(pop_range, levels = pop_levels))\n\npop_groups <- gp2007 %>% \n  group_by(region, pop_range, .drop = FALSE) %>% \n  summarise(`# of Countries` = n(),\n            .groups = 'drop') %>% \n  arrange(region, pop_range) %>% \n  rename(`Population Category` = pop_range)\n\npaged_table(pop_groups)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"region\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Population Category\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"# of Countries\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Africa\",\"2\":\"Less than 500K\",\"3\":\"2\"},{\"1\":\"Africa\",\"2\":\"500K - 1 Million\",\"3\":\"3\"},{\"1\":\"Africa\",\"2\":\"1M - 10 Million\",\"3\":\"21\"},{\"1\":\"Africa\",\"2\":\"10M - 100 Million\",\"3\":\"25\"},{\"1\":\"Africa\",\"2\":\"100M - 1 Billion\",\"3\":\"1\"},{\"1\":\"Africa\",\"2\":\"More than 1 Billion\",\"3\":\"0\"},{\"1\":\"Americas\",\"2\":\"Less than 500K\",\"3\":\"0\"},{\"1\":\"Americas\",\"2\":\"500K - 1 Million\",\"3\":\"0\"},{\"1\":\"Americas\",\"2\":\"1M - 10 Million\",\"3\":\"13\"},{\"1\":\"Americas\",\"2\":\"10M - 100 Million\",\"3\":\"9\"},{\"1\":\"Americas\",\"2\":\"100M - 1 Billion\",\"3\":\"3\"},{\"1\":\"Americas\",\"2\":\"More than 1 Billion\",\"3\":\"0\"},{\"1\":\"Asia-Pacific\",\"2\":\"Less than 500K\",\"3\":\"0\"},{\"1\":\"Asia-Pacific\",\"2\":\"500K - 1 Million\",\"3\":\"1\"},{\"1\":\"Asia-Pacific\",\"2\":\"1M - 10 Million\",\"3\":\"10\"},{\"1\":\"Asia-Pacific\",\"2\":\"10M - 100 Million\",\"3\":\"18\"},{\"1\":\"Asia-Pacific\",\"2\":\"100M - 1 Billion\",\"3\":\"4\"},{\"1\":\"Asia-Pacific\",\"2\":\"More than 1 Billion\",\"3\":\"2\"},{\"1\":\"Europe\",\"2\":\"Less than 500K\",\"3\":\"1\"},{\"1\":\"Europe\",\"2\":\"500K - 1 Million\",\"3\":\"1\"},{\"1\":\"Europe\",\"2\":\"1M - 10 Million\",\"3\":\"14\"},{\"1\":\"Europe\",\"2\":\"10M - 100 Million\",\"3\":\"14\"},{\"1\":\"Europe\",\"2\":\"100M - 1 Billion\",\"3\":\"0\"},{\"1\":\"Europe\",\"2\":\"More than 1 Billion\",\"3\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### Slide 3\n\nSlide 3 contains 2 strings and one chart. The data for the chart looks\nas shown below.\n\n::: {style=\"text-align:center;\"}\n![03_chart table for Slide 3](https://i.imgur.com/kDAbook.png \"Slide 3\"){#fig-slide3}\n:::\n\nThe data for `03_chart` is the list of top 10 countries in each region\nas per latest record i.e. 2007. Let's create the `top10` table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntop10 <- gp %>% \n  filter(year == 2007) %>% \n  group_by(region) %>% \n  slice_max(pop, n = 10, with_ties = FALSE) %>% \n  ungroup() %>% \n  select(-year) %>% \n  mutate(pop = round(pop/1E6, 4)) %>% # population in millions\n  set_names(c(\"region\",\"country\",\"population\"))\n\npaged_table(top10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"region\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"country\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"population\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Africa\",\"2\":\"Nigeria\",\"3\":\"135.0312\"},{\"1\":\"Africa\",\"2\":\"Egypt\",\"3\":\"80.2645\"},{\"1\":\"Africa\",\"2\":\"Ethiopia\",\"3\":\"76.5119\"},{\"1\":\"Africa\",\"2\":\"Congo, Dem. Rep.\",\"3\":\"64.6068\"},{\"1\":\"Africa\",\"2\":\"South Africa\",\"3\":\"43.9978\"},{\"1\":\"Africa\",\"2\":\"Sudan\",\"3\":\"42.2929\"},{\"1\":\"Africa\",\"2\":\"Tanzania\",\"3\":\"38.1396\"},{\"1\":\"Africa\",\"2\":\"Kenya\",\"3\":\"35.6102\"},{\"1\":\"Africa\",\"2\":\"Morocco\",\"3\":\"33.7572\"},{\"1\":\"Africa\",\"2\":\"Algeria\",\"3\":\"33.3332\"},{\"1\":\"Americas\",\"2\":\"United States\",\"3\":\"301.1399\"},{\"1\":\"Americas\",\"2\":\"Brazil\",\"3\":\"190.0106\"},{\"1\":\"Americas\",\"2\":\"Mexico\",\"3\":\"108.7009\"},{\"1\":\"Americas\",\"2\":\"Colombia\",\"3\":\"44.2276\"},{\"1\":\"Americas\",\"2\":\"Argentina\",\"3\":\"40.3019\"},{\"1\":\"Americas\",\"2\":\"Canada\",\"3\":\"33.3901\"},{\"1\":\"Americas\",\"2\":\"Peru\",\"3\":\"28.6748\"},{\"1\":\"Americas\",\"2\":\"Venezuela\",\"3\":\"26.0847\"},{\"1\":\"Americas\",\"2\":\"Chile\",\"3\":\"16.2847\"},{\"1\":\"Americas\",\"2\":\"Ecuador\",\"3\":\"13.7557\"},{\"1\":\"Asia-Pacific\",\"2\":\"China\",\"3\":\"1318.6831\"},{\"1\":\"Asia-Pacific\",\"2\":\"India\",\"3\":\"1110.3963\"},{\"1\":\"Asia-Pacific\",\"2\":\"Indonesia\",\"3\":\"223.5470\"},{\"1\":\"Asia-Pacific\",\"2\":\"Pakistan\",\"3\":\"169.2706\"},{\"1\":\"Asia-Pacific\",\"2\":\"Bangladesh\",\"3\":\"150.4483\"},{\"1\":\"Asia-Pacific\",\"2\":\"Japan\",\"3\":\"127.4680\"},{\"1\":\"Asia-Pacific\",\"2\":\"Philippines\",\"3\":\"91.0773\"},{\"1\":\"Asia-Pacific\",\"2\":\"Vietnam\",\"3\":\"85.2624\"},{\"1\":\"Asia-Pacific\",\"2\":\"Iran\",\"3\":\"69.4536\"},{\"1\":\"Asia-Pacific\",\"2\":\"Thailand\",\"3\":\"65.0681\"},{\"1\":\"Europe\",\"2\":\"Germany\",\"3\":\"82.4010\"},{\"1\":\"Europe\",\"2\":\"Turkey\",\"3\":\"71.1586\"},{\"1\":\"Europe\",\"2\":\"France\",\"3\":\"61.0839\"},{\"1\":\"Europe\",\"2\":\"United Kingdom\",\"3\":\"60.7762\"},{\"1\":\"Europe\",\"2\":\"Italy\",\"3\":\"58.1477\"},{\"1\":\"Europe\",\"2\":\"Spain\",\"3\":\"40.4482\"},{\"1\":\"Europe\",\"2\":\"Poland\",\"3\":\"38.5182\"},{\"1\":\"Europe\",\"2\":\"Romania\",\"3\":\"22.2761\"},{\"1\":\"Europe\",\"2\":\"Netherlands\",\"3\":\"16.5706\"},{\"1\":\"Europe\",\"2\":\"Greece\",\"3\":\"10.7063\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## The `for` loop!\n\nWe now have to load the Excel template with the data at appropriate cell\nlocations for one region at a time. Since we have about 4 regions, we\nwill create a vector of unique regions to iterate over.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique_regions <- gp %>% distinct(region) %>% pull()\ncat(unique_regions, sep = \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAsia-Pacific\nEurope\nAfrica\nAmericas\n```\n:::\n:::\n\n\nAs our last step, we will create the `for` loop that will iterate over\n`unique_regions` , filter the datasets for each region, write them to\nthe Excel Template, save the template with temporary name. We save the\nfile with different name to prevent unintentionally corrupting the Excel\nmacro template. Finally, we run the macro in the renamed file.\n\nThe code will look something like this\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (region in unique_regions) {\n  \n  # Step 1: filter the data sets\n  # Step 2: write the data sets\n  # Step 3: save the excel template with different name\n  # Step 4: load the renamed Excel file\n  # Step 5: run macro\n}\n```\n:::\n\n\nLet's populate the above `for` loop with the code we need.\n\n\n::: {.cell .column-body-outset-right}\n\n```{.r .cell-code}\nfor (curr_region in unique_regions) {\n  \n  # Step 1: filter the data sets\n  \n  # Slide 1\n  S1_title <- paste(curr_region, \"Population\")\n  S1_subtitle <- paste(\"Vishal Katti\",\"|\",format(Sys.Date(),\"%b %d, %Y\"), sep = \"   \")\n  \n  # Slide 2\n  S2_title <- paste(curr_region, \"Population since 1952\")\n  \n  S2_top4 <- top4        %>% filter(region == all_of(curr_region)) %>% select(-region) %>% arrange(desc(`2007`))\n  S2_others <- others    %>% filter(region == all_of(curr_region)) %>% select(-region)\n  S2_top5 <- bind_rows(S2_top4, S2_others)\n  \n  S2_table <- pop_groups %>% filter(region == all_of(curr_region)) %>% select(-region)\n  \n  # Slide 3\n  S3_title <- paste(\"Top 10 most populated countries in\", curr_region)\n  \n  S3_chart <- top10      %>% filter(region == all_of(curr_region)) %>% select(-region)\n  \n  S3_factoid <- paste(\"The population of\", S3_chart$country[1], \"is approx.\",\n                      round(S3_chart$population[1]/S3_chart$population[10], 0),\n                      \"times that of\", S3_chart$country[10])\n  \n  # Step 2: write the data sets\n  \n  # Load the template\n  wb <- loadWorkbook(\"path/to/template/XL2PPT.xlsm\") # relative to this R script\n  sht <- \"Sheet1\"\n  \n  # write data to coordinate (col, row)\n  writeData(wb, sht, S1_title,    xy = c(3, 3),  colNames = FALSE)\n  writeData(wb, sht, S1_subtitle, xy = c(3, 4),  colNames = FALSE)\n  writeData(wb, sht, S2_title,    xy = c(3, 7),  colNames = FALSE)\n  writeData(wb, sht, S2_top5,     xy = c(3, 9),  colNames = TRUE)\n  writeData(wb, sht, S2_table,    xy = c(18, 9), colNames = TRUE)\n  writeData(wb, sht, S3_title,    xy = c(3, 18), colNames = FALSE)\n  writeData(wb, sht, S3_factoid,  xy = c(3, 19), colNames = FALSE)\n  writeData(wb, sht, S3_chart,    xy = c(3, 21), colNames = TRUE)\n  \n  # Step 3: save the excel template with different name\n  saveWorkbook(wb, \"path/to/template/XL2PPT_edited.xlsm\", overwrite = TRUE)\n  gc(verbose = TRUE)\n  Sys.sleep(2)\n  \n  # Step 4: load the renamed Excel file\n  # Create Excel Application\n  xlApp <- COMCreate(\"Excel.Application\")\n\n  # Open the Macro Excel book\n  xlWbk <- xlApp$Workbooks()$Open(normalizePath(\"path/to/template/XL2PPT_edited.xlsm\", winslash = \"/\")) # Change to your directory\n  # its ok to run macro without visible excel application\n  # If you want to see your workbook, please set it to TRUE\n  xlApp[[\"Visible\"]] <- FALSE\n  \n  # Step 5: run macro\n  xlApp$Run(\"Create_Continental_Deck\") # Name of Macro to run\n\n  xlWbk$Close(TRUE) # save and close excel book\n  xlApp$Quit()\n  gc(verbose = TRUE)\n  Sys.sleep(2)\n}\n```\n:::\n\n\nOnce the code runs completely, you will see 4 new PowerPoint\nPresentations in your working folder.\n\n::: {style=\"text-align:center;\"}\n![Output Files](https://i.imgur.com/Pe8yyxI.png \"Output Files\"){#fig-output-files}\n:::\n\nYou can download the full R script from\n[here](https://gist.github.com/vkatti/cc95c56e11c1b8985bbd288f353c7386 \"Navigate to Github Gist\").\n\n## References & Citations\n\n-   Jennifer Bryan (2017). gapminder: Data from Gapminder. R package\n    version 0.3.0. <https://CRAN.R-project.org/package=gapminder>\n\n-   Hadley Wickham, Romain Francois, Lionel Henry and Kirill Muller\n    (2021). dplyr: A Grammar of Data Manipulation. R package version\n    1.0.7. <https://CRAN.R-project.org/package=dplyr>\n\n-   Hadley Wickham (2021). tidyr: Tidy Messy Data. R package version\n    1.1.3. <https://CRAN.R-project.org/package=tidyr>\n\n-   Greg Lin (2020). reactable: Interactive Data Tables Based on 'React\n    Table'. R package version 0.2.3.\n    <https://CRAN.R-project.org/package=reactable>\n\n-   Philipp Schauberger and Alexander Walker (2021). openxlsx: Read,\n    Write and Edit xlsx Files. R package version 4.2.4.\n    <https://CRAN.R-project.org/package=openxlsx>\n\n-   Duncan Temple Lang (NA). RDCOMClient: R-DCOM client.\n    <http://www.omegahat.net/RDCOMClient,> <http://www.omegahat.net>\n    <http://www.omegahat.net/bugs.>\n\n-   <https://docs.microsoft.com/en-us/office/vba/api/overview/excel>\n\n-   <https://docs.microsoft.com/en-us/office/vba/api/overview/powerpoint>\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}